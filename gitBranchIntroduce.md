# Odoo分支模型介绍  

该分支模型将分支分为生产分支, 开发分支, 个人分支, 发布分支和热修分支.  
在代码库长久存在的只有生产分支和开发分支. 其他分支则有可能被删除或重新创建.  
开发分支为主要分支, 其余分支都应该从该分支上签出.

对于每个分支都要求的测试, 以保证正常的工作流程.  
1. 个人分支的每一次整理后的提交, 都要进行单元测试, 保证针对这个提交相关的功能能正常运行, 使得开发分支回滚到任意一个提交都能正常运行.
2. 在个人分支变基到开发分支的最新节点后, 要求集成测试, 保证各模块之间能正常的协作运行, 不会导致其他模块产生错误.
3. 热修或发布分支在签出后, 要求进行一次完备的系统测试, 确保新版本能持续可靠的运行.
4. 在完成热修分支和发布分支上的错误修复后, 要求进行回归测试, 保证没有因为修复错误而产生的新错误.


## 生产分支/master分支  
生产分支旨在提供一个运行稳定, 功能完善的版本. 其上的提交记录不与开发分支关联, 主要是提供版本记录. 
每一次生产分支的更新都要求经过系统测试, 保证没有没有影响用户使用的恶性错误.  
生产分支的更新有以下 __要求:__  
1. 生产分支应设为保护分支, 不允许删除, 只接受来自维护者的推送.  
2. 更新只能从发布分支或热修分支发布.  
3. 保持线性提交, 拒绝合并提交记录.  
4. 每次提交必须标记版本标签, 根据更新的来源确定新版本号.  
    *	来自发布分支的更新: 大型完整更新发布时, 版本号增加1.0.0; 发布某些新功能点时, 版本号增加0.1.0;  
    *	来自热修分支的更新: 每次热修更新, 版本号增加0.0.1;  

## 开发分支/develop分支  
开发分支拥有最新的集成代码, 记录着除生产分支以外所有分支上的每一次提交记录, 每一次提交记录都对应一次问题或功能.  

为了报证这些提交记录的直观与简洁, 提出以下 __要求:__  
1. 开发分支应设为保护分支, 不允许删除, 可接受来自维护者和开发者的推送.    
2. 开发分支应保持线性提交, 拒绝合并的提交记录.  
3. 每次提交包含且只包含一个独立的功能点, 要经过单元测试和集成, 保证该提交的代码可直接运行.


## 个人分支/feature分支  
为了不影响开发分支上的代码, 开发者需要从开发分支上签出个人分支, 日常开发等都在个人分支上进行.  

个人分支的要求和限制:
1. 个人分支允许被删除和强制推送, 但删除后应立即创建, 保证其在远程仓库始终存在.  
2. 该分支上的提交不做限制, 但在向开发分支合并时则需要整理提交记录. 因此个人分支应该尽可能地保证清晰的提交记录, 以减少后面合并时的工作量. 
3. 合并时进行集成测试, 防止影响其他模块运行.  

整理提交记录时, 合并无意义的提交记录(例如: 保存代码用的提交, 临时的提交), 每次提交应为一个尽可能小的, 独立的功能点或问题.



## 发布分支/release 分支  

当我们的开发进行到某个里程碑时, 我们可能需要这些新功能发布到生产分支上, 此时我们就需要创建一个发布分支.  
发布分支应从开发分支签出, 在发布分支上进行新版本发布的最后测试工作.   
如果测试过程中出现了发现了问题:  
* 在一个人即可独立解决的情况下, 可直接在发布分支上进行开发.
* 如果需要多人合作时, 则应该在发布分支上签出每位开发者的个人发布分支(命名规则为: release-<USER_NAME>; 例如: release-ben), 完成开发后合并到一起.  

发布分支的要求或限制: 
1. 允许删除和强制推送, 完成修改后应该合并到生产分支和开发分支.  
2. 产生改动后需要进行回归测试, 防止新的问题产生.  
3. 合并到生产分支时, 要将所有提交合并成一个, 并为这一提交打上版本标签. (通常是增加0.1.0; 发布大型版本时增加1.0.0)
4. 合并到开发分支时, 要整理发布分支上的提交, 保留这次发布过程中的修改记录.


## 热修分支/hotfix 分支  

当生产分支的在代码在使用过程中发现了某些十分严重, 影响系统运行的恶性bug时, 我们需对其进行紧急的修复.   
这时, 我们就需要创建热修分支.  
当修复这些bug需要多人合作进行时, 应在热修分支的基础上签出新的个人热修分支, 并命名为 hotfix-<USER_NAME>.  

热修分支的要求或限制:  
1. 允许删除和强制推送, 完成修改后合并到生产分支和开发分支.  
2. 产生改动后需要进行回归测试, 防止新的问题产生. 
3. 合并到生产分支时, 要将所有提交合并成一个, 并为这一提交打上版本标签(递增0.0.1).  
4. 合并到开发分支时, 要整理发布分支上的提交, 保留这次发布过程中的修改记录.



